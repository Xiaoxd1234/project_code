任务4 - 构建健壮的图书馆系统 [10分]
多亏了你之前的工作，图书馆现在有了一个可用的系统。然而，图书管理员报告说CSV文件中的某些记录因无效值而损坏。这导致系统出现异常行为，有时甚至在繁忙的考试期间崩溃，给学生带来不必要的压力。

在真实的软件工程中，健壮性和正确性与功能性同样重要。程序必须能够优雅地处理意外情况和无效输入，而不是直接崩溃。开发者常用的两种关键方法是：

断言（Assertions）：内部检查，用于验证程序员假设的条件（例如，“这个变量绝不能为负”）。断言主要用于开发和调试阶段。

防御性编程（Defensive programming）：验证输入和使用模式，防止运行时出现无效或意外行为。这包括检查类型、数值范围，并在出错时提供有用的错误信息。

任务说明
在本任务中，你将通过添加自定义错误处理来扩展你的图书馆系统，使其更加健壮。Python已经会抛出内置错误，但这里你必须定义并使用自定义异常（在 custom_errors.py 中），以处理图书馆特定的错误情况。

在任务3的基础上，更新你的 user.py 和 book.py 模块以处理无效输入，并修改 task4.py 以优雅地处理异常，确保系统不会崩溃。

你必须确保系统：

正确：通过使用 assert 验证逻辑中的假设。
安全：通过防御性编程技术防止无效输入（如错误类型、负数等）。

在本任务中我们将使用自定义错误，因为当我们执行无效代码时，Python已经会抛出一些内置错误。我们的新错误位于 custom_errors.py。你必须使用这些自定义错误，具体请参见评分标准。

在审核CSV数据后，图书管理员引入了新的验证规则，需在任务1-3要求基础上额外应用。这些规则加强了数据质量，防止损坏记录进入系统。

用户
- 每个用户必须有密码，密码不能为空。
- 用户姓名中的每个单词只能包含字母字符。不能有数字、符号或特殊字符。
- 学生和教职工必须填写部门，其他用户部门必须为空。有效部门仅限：IT、Business、Arts、Science、Engineering、Education、Medicine 和 Library。

图书
- 图书馆只认可两种有效书籍类型：实体书和在线书。
- 所有书籍必须填写以下字段：书名、作者、年份。
- 每本书最多可有5个关键词。
- 关键词只能包含字母和数字。唯一允许的特殊字符是连字符（-）。

借阅
- 每条借阅记录必须关联现有用户和现有书籍。
- 到期日为必填项，不能为空。

防御性编程
custom_errors.py 中为你提供了以下异常：

CustomTypeError：
值类型错误（如字符串代替浮点数或整数）。

CustomValueError：
值类型正确但无效（如副本数为负）。

CustomDateError：
日期格式错误或日期逻辑无效（如借书日期在未来）。

MissingRequiredFieldError：
缺少必填字段时抛出。

UserNotFoundError 或 BookNotFoundError：
借阅记录引用不存在的用户或书籍时抛出。

CustomOperationError：
尝试无效借书或还书操作时抛出。

CustomLimitError：
用户超出配额或借阅限制时抛出。

CustomKeyError：
当你尝试访问字典中不存在的键时发生。Thanks to your work so far, the library now has a functioning system. However, librarians have reported that some records in the CSV files are corrupted with invalid values. This has caused misbehaviour in the system, sometimes even crashing during busy exam periods, creating unnecessary stress for students.

In real-world software engineering, robustness and correctness are just as important as functionality. Programs must gracefully handle unexpected situations and invalid inputs without failing. Two key approaches developers use are:

Assertions: Internal checks that validate assumptions made by the programmer (e.g., "This variable should never be negative"). Assertions are mainly used during development and debugging.

Defensive programming: Validates inputs and usage patterns to prevent invalid or unexpected behaviour at runtime. This includes checking for correct types, value ranges, and providing helpful error messages when something goes wrong.

Description
In this task, you will extend your library system by adding custom error handling to make it more robust. Python already raises built-in errors, but here you must define and use custom exceptions (in custom_errors.py) to handle library-specific error conditions.

Building upon Task 3, update your user.py and book.py modules to handle invalid input, and modify task4.py to handle exceptions gracefully so that the system does not crash.

You must ensure that this system is:

Correct: Through use of assert to validate assumptions in your logic.

Safe: Through defensive programming techniques that prevent invalid inputs (e.g. wrong types, negative amounts).

In this task we will be using custom errors as python will already raise some of these errors when we execute invalid code. Our new errors are located in cusom_errors.py. You must use these custom errors, please see rubric for related penalties in this task.

After auditing the CSV data, the librarian has introduced new validation rules to be applied in addition to the requirements described in Tasks 1–3. These rules strengthen data quality and prevent corrupted records from entering the system.

Users

Every user must have a password. Passwords cannot be empty.

Every word in a user's name must contain only alphabetic characters. Numbers, symbols, and special characters are not allowed.

Department is mandatory for students and staff, but must remain empty for other users. The only valid departments are: IT, Business, Arts, Science, Engineering, Education, Medicine and Library.

Books

The library only recognizes two valid book types: physical and online.

The following fields are required for all books: Title, Author, Year

Each book may have at most 5 keywords. 

Keywords must consist of letters and numbers only. The only allowed special character is the hyphen (-).

Loans

Every loan record must be associated with an existing user and an existing book.

The due date is a required field and cannot be left empty.

Defensive Programming
The following exceptions are provided to you in custom_errors.py:

CustomTypeError:

A value is the wrong type (e.g. a string instead of a float or int).

CustomValueError:

A value is of the correct type but invalid (e.g. negative copies).

CustomDateError:

Raised when a date is in the wrong format or when the date logic is invalid (e.g., borrow date occurs in the future).

MissingRequiredFieldError:

Raised when a required field is missing.

UserNotFoundError or BookNotFoundError:

Raised when a loan references a user or book that does not exist.

CustomOperationError :

Raised when an invalid borrow or return action is attempted.

CustomLimitError:

Raised when a user exceeds their quota or borrowing limit.

CustomKeyError:

Occurs when you try to access a key in the dictionary that doesn't exist. 这个是task 4