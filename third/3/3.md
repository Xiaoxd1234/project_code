任务3 - 轻松搜索 [10分]
你的图书馆系统正在不断完善。用户现在可以轻松登录、借书和还书。但仍有一个问题：找到合适的书并不总是那么容易。当前的搜索功能只有在用户知道确切书名时才有效。想象一下考试周压力大的学生，只记得“关于机器学习的某本书”，却记不清全名——这很让人沮丧，对吧？

图书管理员希望通过引入基于关键词的搜索来解决这个问题，让用户可以更自然地浏览目录。此外，大学刚刚获得了额外资金扩充藏书，你的系统现在必须支持向数据库添加全新书籍。

任务描述
主菜单更新
对于学生、非图书馆工作人员和其他用户，主菜单新增“按关键词搜索”（选项5）。

以学生Chris Manner登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
==================================
请输入你的选择：

对于图书馆工作人员，除了“按关键词搜索”（选项5），原有“图书馆报告”选项扩展为“管理图书馆”（选项6），提供更多管理功能（后文描述）。

以教职工Mary Alan登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
6. 管理图书馆
==================================
请输入你的选择：

续借
所有用户可在借书与还书控制台使用命令 renew <书籍ID> 对每本借阅书进行一次续借。

续借将到期日延长5天。

如果用户借了同一本书的多本副本，系统会优先续借到期日最早的副本（或借阅记录）。

以下情况不能续借：
- 延长后的到期日已过（已逾期），系统将显示“续借被拒：该书已逾期。”
- 用户已续借过一次，系统将显示“续借不可用：每本书只能续借一次。”
- 有未支付罚款的用户不能续借，系统将显示“续借被拒：你有未支付罚款。”

归还验证优先级与任务2中的借书验证优先级类似。
系统先检查用户是否有续借资格，再验证借阅记录是否有效且可续借。

以学生Chris Manner登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
==================================
请输入你的选择：4
> renew P0011
续借被拒：你有未支付罚款。

如果借阅记录不存在，将返回错误。

以其他用户Noah登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
==================================
请输入你的选择：4
> renew P0011
没有P0011的借阅记录。

按关键词搜索
选择5后，系统会提示输入关键词列表（不区分大小写），用逗号分隔。程序将搜索目录，返回至少包含一个指定关键词的书籍列表。

结果排序优先级如下：
- 匹配关键词数量（多的优先）
- 出版年份（新的优先）
- 书籍ID（升序）

如果关键词列表为空，程序应返回“找到0本书。”

以其他用户Noah登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
==================================
请输入你的选择：5
请输入搜索关键词（用逗号分隔）：python,programming
找到7本书：
1. P0003《Python Crash Course》作者：Eric Matthes（2023）。
2. P0001《Introduction to Python Programming》作者：S Gowrishankar（2019）。
3. E0002《Deep learning with Python: a hands-on introduction》作者：Ketkar Nikhil（2017）。
4. E0001《Python Crash Course》作者：Eric Matthes（2015）。
5. P0002《Python Programming: An Introduction to Computer Science》作者：John M. Zelle（2002）。
6. E0003《Machine Learning for Business》作者：Doug Hudgeon & Richard Nichol（2020）。
7. P0006《Hands-On ML》作者：Aurelien Geron（2019）。

管理图书馆（仅限图书馆工作人员）
工作人员选择6进入管理图书馆控制台，可执行以下操作：
- 输入 report 打印图书馆报告
- 添加新书
使用命令 add physical 添加新实体书，或 add online 添加新在线书。
系统会提示输入书籍详细信息，包括书名、作者、年份、实体书需输入副本数。
系统会自动根据书名中的词与 books.csv 数据集中的关键词列表（按字母排序）进行匹配，为新书分配关键词。
每本新书分配唯一ID：
- 实体书ID以P开头
- 在线书ID以E开头
- 数字部分由馆内该类型书籍最大ID递增生成
输入 quit 退出借书与还书控制台，返回主菜单。

以教职工Mary Alan登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
6. 管理图书馆
==================================
请输入你的选择：6
> report
图书馆报告
- 9名用户，包括4名学生、3名教职工和2名其他。
- 14本书，包括10本实体书（7本当前可借）和3本在线书。
> add physical
书名：A Concise and Practical Introduction to Programming Algorithms in Java
作者：Nielsen Frank
年份：2017
副本数：1
检测到关键词：algorithms:programming
正在添加 P0020《A Concise and Practical Introduction to Programming Algorithms in Java》作者：Nielsen Frank（2017）。

示例
示例1
欢迎来到图书馆
登录名：s31267
密码：chr1267
以学生Chris Manner登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
==================================
请输入你的选择：2
学生 Chris Manner。政策：最多10天，4本。当前借阅：2（1本实体/1本在线）。罚款：$1.00
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
==================================
请输入你的选择：3
你当前有2条借阅记录：
1. P0006《Hands-On ML》作者：Aurelien Geron（2019）。到期日：13/09/2025。
2. E0001《Python Crash Course》作者：Eric Matthes（2015）。到期日：15/09/2025。
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
==================================
请输入你的选择：4
> renew P0101
续借被拒：你有未支付罚款。
> return P0006
已归还《Hands-On ML》作者：Aurelien Geron（2019）。逾期2天。罚款：$1.00
> renew E0001
续借被拒：该书已逾期。
> return E0001
已归还《Python Crash Course》作者：Eric Matthes（2015）。
> borrow The Hobbit
找到1本书：
- P0008（实体）《The Hobbit》作者：J.R.R. Tolkien（1937）。可借副本：1/2。
请确认要借的书籍ID：P0008
你已借阅《The Hobbit》作者：J.R.R. Tolkien（1937）。到期：25/09/2025。
> renew P0008
成功续借《The Hobbit》作者：J.R.R. Tolkien（1937）。新到期日：30/09/2025
> quit
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
==================================
请输入你的选择：3
你当前有1条借阅记录：
1. P0008《The Hobbit》作者：J.R.R. Tolkien（1937）。到期日：30/09/2025。
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
==================================
请输入你的选择：0
再见！

示例2
欢迎来到图书馆
登录名：o56799
密码：noa6799
以其他用户Noah登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
==================================
请输入你的选择：5
请输入搜索关键词（用逗号分隔）：python,programming
找到7本书：
1. P0003《Python Crash Course》作者：Eric Matthes（2023）。
2. P0001《Introduction to Python Programming》作者：S Gowrishankar（2019）。
3. E0002《Deep learning with Python: a hands-on introduction》作者：Ketkar Nikhil（2017）。
4. E0001《Python Crash Course》作者：Eric Matthes（2015）。
5. P0002《Python Programming: An Introduction to Computer Science》作者：John M. Zelle（2002）。
6. E0003《Machine Learning for Business》作者：Doug Hudgeon & Richard Nichol（2020）。
7. P0006《Hands-On ML》作者：Aurelien Geron（2019）。
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
==================================
请输入你的选择：4
> borrow E0003
找到1本书：
- E0003（在线）《Machine Learning for Business》作者：Doug Hudgeon & Richard Nichol（2020）。可借副本：0/0。
请确认要借的书籍ID：E0003
你已借阅《Machine Learning for Business》作者：Doug Hudgeon & Richard Nichol（2020）。到期：22/09/2025。
> quit
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
==================================
请输入你的选择：3
你当前有1条借阅记录：
1. E0003《Machine Learning for Business》作者：Doug Hudgeon & Richard Nichol（2020）。到期日：22/09/2025。
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
==================================
请输入你的选择：0
再见！

示例3
欢迎来到图书馆
登录名：e118102
密码：pa55word
以教职工Mary Alan登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
6. 管理图书馆
==================================
请输入你的选择：6
> report
图书馆报告
- 9名用户，包括4名学生、3名教职工和2名其他。
- 14本书，包括10本实体书（7本当前可借）和4本在线书。
> add physical
书名：A Concise and Practical Introduction to Programming Algorithms in Java
作者：Nielsen Frank
年份：2017
副本数：1
检测到关键词：algorithms:programming
正在添加 P0020《A Concise and Practical Introduction to Programming Algorithms in Java》作者：Nielsen Frank（2017）。
> report
图书馆报告
- 9名用户，包括4名学生、3名教职工和2名其他。
- 15本书，包括11本实体书（8本当前可借）和4本在线书。
> quit
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 按关键词搜索
6. 管理图书馆
==================================
请输入你的选择：0
再见！
Your library system is steadily evolving. Users can now log in, borrow, and return books with ease. But one problem remains: finding the right book isn't always so easy. The current search function only works if users know the exact title. Imagine being a stressed student during exam week, remembering only "something about machine learning" but not the full book title -- frustrating, right?

The librarians want to fix this by introducing a keyword-based search, so users can explore the catalogue more naturally. On top of that, the university has just secured extra funding to expand the collection, and your system must now support adding brand-new books into the database.

Task Description
Updated Main Menu 
For students, staff (non-library) and other users, a new option, Search by Keywords (Option 5), is added to the main menu.

Logged in as Chris Manner (Student)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
==================================
Enter your choice:

For library staff, alongside Search by Keywords (option 5), the existing Library Report option is expanded into Manage Library (option 6), offering more administrative features (described later).

Logged in as Mary Alan (Staff)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
6. Manage Library
==================================
Enter your choice:

Renew loan
All users may renew each borrowed book once, using the command renew <book ID> in the Borrow and Return console.

Renewal extends the due date by 5 days.

If the user has borrowed multiple copies of the same book, the system will renew the copy (or loan) with the earliest due date first.

A book is not eligible for renewal if:

Its extended due date has already passed (making it overdue). An error message "Renewal denied: This book is already overdue." will be printed out instead.

If it is already renewed once by the user, the system will display "Renewal unavailable: Each book can only be renewed once."

Users with unpaid fines cannot renew any loans until their fines are settled. The system will display "Renewal denied: You have unpaid fines."

Returning validation priority is similar to borrowing validation priority in Task 2.

The system first checks whether the user is eligible to renew.

Then it verifies if the loan is valid and is eligible to renew.

Logged in as Chris Manner (Student)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
==================================
Enter your choice: 4
> renew P0011
Renewal denied: You have unpaid fines.

An error will return if the loan record does not exist

Logged in as Noah (Others)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
==================================
Enter your choice: 4
> renew P0011
No loan record for P0011.

Search by Keywords
Upon entering 5,  the system will prompt them to enter a list of keywords (case insensitive), separated by commas (,). The program will then search the catalogue and return a list of books that contain at least one of the specified keywords.

The results will be sorted in the following order of priority:

Number of matched keywords (highest first)

Publication year (newest first)

Book ID (ascending order)

If the keyword list is empty, the program should return "Found 0 book(s)."

Logged in as Noah (Others)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
==================================
Enter your choice: 5
Enter search keywords (separated by comma): python,programming
Found 7 book(s).
1. P0003 'Python Crash Course' by Eric Matthes (2023).
2. P0001 'Introduction to Python Programming' by S Gowrishankar (2019).
3. E0002 'Deep learning with Python: a hands-on introduction' by Ketkar Nikhil (2017).
4. E0001 'Python Crash Course' by Eric Matthes (2015).
5. P0002 'Python Programming: An Introduction to Computer Science' by John M. Zelle (2002).
6. E0003 'Machine Learning for Business' by Doug Hudgeon & Richard Nichol (2020).
7. P0006 'Hands-On ML' by Aurelien Geron (2019).

Manage Library (Library Staff only)
When staff members select option 6 to enter the Manage Library console, they can perform the following actions:

Print library report by enter report

Add a New Book

Use the command add physical to add a new physical book, or add online to add a new online book.

The system will then prompt the user to provide the book’s details, including  title, authors, year, number of copies (required for physical books only)

The system will automatically assign keywords to newly added books by matching any words in their titles with the existing keyword list from the books.csv dataset (sorted by alphabet order).

Each new book is assigned a unique ID:

IDs for physical books begin with P.

IDs for online books begin with E.

The numeric portion of the ID is generated by incrementing the highest existing ID of that type in the library.

Type quit to exit the borrow and return console and go back to main menu.

Logged in as Mary Alan (Staff)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
6. Manage Library
==================================
Enter your choice: 6
> report
Library Report
- 9 users, including 4 student(s), 3 staff and 2 others.
- 14 books, including 10 physical book(s) (7 currently available) and 3 online book(s).
> add physical
Title: A Concise and Practical Introduction to Programming Algorithms in Java
Authors: Nielsen Frank
Year: 2017
Copies: 1
Detected keywords: algorithms:programming
Adding P0020 'A Concise and Practical Introduction to Programming Algorithms in Java' by Nielsen Frank (2017).

Examples
Example 1
Welcome to Library
Login as: s31267
Password: chr1267
Logged in as Chris Manner (Student)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
==================================
Enter your choice: 2
Student Chris Manner. Policies: maximum of 10 days, 4 items. Current loans: 2 (1 physical / 1 online). Fines: $ 1.00
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
==================================
Enter your choice: 3
You are currently have 2 loan(s).
1. P0006 'Hands-On ML' by Aurelien Geron (2019). Due date: 13/09/2025.
2. E0001 'Python Crash Course' by Eric Matthes (2015). Due date: 15/09/2025.
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
==================================
Enter your choice: 4
> renew P0101
Renewal denied: You have unpaid fines.
> return P0006
Returned 'Hands-On ML' by Aurelien Geron (2019). Overdue by 2 day(s). Fine: $ 1.00
> renew E0001
Renewal denied: This book is already overdue.
> return E0001
Returned 'Python Crash Course' by Eric Matthes (2015).
> borrow The Hobbit
Found 1 book(s).
- P0008 (physical) 'The Hobbit' by J.R.R. Tolkien (1937). Available copies: 1/2.
Confirm the Book ID you'd like to borrow: P0008
You have borrowed 'The Hobbit' by J.R.R. Tolkien (1937). Due: 25/09/2025.
> renew P0008
Renew 'The Hobbit' by J.R.R. Tolkien (1937) successfully. New due date: 30/09/2025
> quit
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
==================================
Enter your choice: 3
You are currently have 1 loan(s).
1. P0008 'The Hobbit' by J.R.R. Tolkien (1937). Due date: 30/09/2025.
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
==================================
Enter your choice: 0
Goodbye!

Example 2
Welcome to Library
Login as: o56799
Password: noa6799
Logged in as Noah (Others)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
==================================
Enter your choice: 5
Enter search keywords (separated by comma): python,programming
Found 7 book(s).
1. P0003 'Python Crash Course' by Eric Matthes (2023).
2. P0001 'Introduction to Python Programming' by S Gowrishankar (2019).
3. E0002 'Deep learning with Python: a hands-on introduction' by Ketkar Nikhil (2017).
4. E0001 'Python Crash Course' by Eric Matthes (2015).
5. P0002 'Python Programming: An Introduction to Computer Science' by John M. Zelle (2002).
6. E0003 'Machine Learning for Business' by Doug Hudgeon & Richard Nichol (2020).
7. P0006 'Hands-On ML' by Aurelien Geron (2019).
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
==================================
Enter your choice: 4
> borrow E0003
Found 1 book(s).
- E0003 (online) 'Machine Learning for Business' by Doug Hudgeon & Richard Nichol (2020). Available copies: 0/0.
Confirm the Book ID you'd like to borrow: E0003
You have borrowed 'Machine Learning for Business' by Doug Hudgeon & Richard Nichol (2020). Due: 22/09/2025.
> quit
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
==================================
Enter your choice: 3
You are currently have 1 loan(s).
1. E0003 'Machine Learning for Business' by Doug Hudgeon & Richard Nichol (2020). Due date: 22/09/2025.
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
==================================
Enter your choice: 0
Goodbye!

Example 3
Welcome to Library
Login as: e118102
Password: pa55word
Logged in as Mary Alan (Staff)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
6. Manage Library
==================================
Enter your choice: 6
> report
Library report
- 9 users, including 4 student(s), 3 staff, and 2 others.
- 14 books, including 10 physical book(s) (7 currently available) and 4 online book(s).
> add physical
Title: A Concise and Practical Introduction to Programming Algorithms in Java
Authors: Nielsen Frank
Year: 2017
Copies: 1
Detected keywords: algorithms:programming
Adding P0020 'A Concise and Practical Introduction to Programming Algorithms in Java' by Nielsen Frank (2017).
> report
Library report
- 9 users, including 4 student(s), 3 staff, and 2 others.
- 15 books, including 11 physical book(s) (8 currently available) and 4 online book(s).
> quit
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Search by Keywords
6. Manage Library
==================================
Enter your choice: 0
Goodbye!