任务2 - 借阅与归还图书 [8分]
在任务1中，你的程序能够加载数据，显示现有用户信息和借阅历史。现在，是时候帮助图书管理员管理日常图书馆系统，包括借书和还书。

任务描述
罚款
如果用户在到期日之后归还实体书，或者到期日已过且书仍未归还（例如截至今天，2025年9月15日），将会收取罚款。在线书籍免于罚款，因为一旦到期，阅读平台会自动撤销访问权限。

罚款仅从到期日后的第二天开始累计（包括任何适用的宽限期），并持续到物品归还为止。对于仍在借阅中的物品，罚款计算至今天（2025年9月15日）。所有罚款在归还图书时需一次性支付。

在任务2-5中，我们假设今天是2025年9月15日。user.py中已创建常量TODAY，方便你使用。如有需要可自行修改。

每日罚款和宽限期因角色而异：

用户类型   宽限期（天）   每日罚款
学生       0           $0.50
教职工     2           $0.50
其他       0           $1.00

更新后的主菜单
在“查看账户政策”中添加罚款信息，并新增“借书与还书”控制台。

以学生Chris Manner登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：2
学生 Chris Manner。政策：最多10天，4本。当前借阅：2（1本实体/1本在线）。罚款：$1.00

以下是图书馆工作人员菜单的修改版

以教职工Mary Alan登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 图书馆报告
==================================
请输入你的选择：

借书与还书
在本任务及后续任务中，不要创建文件或写入现有csv文件。

进入借书与还书控制台（选择4）后，程序会在带有 > 的行提示用户输入命令。

用户可以输入 borrow <X>，其中 <X> 是书名或书籍ID。

如果有多本书同名，程序会显示所有匹配书籍及其ID（按ID排序），然后要求你输入ID确认。ID必须是列表中的一个。如果输入无效ID，程序会再次提示，直到输入有效ID或输入 quit。

只有在以下情况下才能借书（见示例3）：
- 图书在馆藏中存在。
- 剩余副本可借。在线书籍始终可借，不计入借阅额度。
- 未超出借阅额度。
- 没有未支付罚款。

借书验证优先级：
系统首先检查用户是否有借阅资格，即额度未满且无未支付罚款。
然后验证所请求书籍是否存在，再检查可借副本数量。

输入 quit 可退出借书与还书控制台，返回主菜单。

以其他用户Noah登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：4
> borrow Hobbit
没有匹配“Hobbit”的书。
> borrow Python Crash Course
找到2本书：
- E0001（在线）《Python Crash Course》作者：Eric Matthes（2015）。可借副本：0/0。
- P0003（实体）《Python Crash Course》作者：Eric Matthes（2023）。可借副本：2/2。
请确认要借的书籍ID：P0003
你已借阅《Python Crash Course》作者：Eric Matthes（2023）。到期：22/09/2025。
> quit
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：

用户也可以通过书籍ID借书

> borrow E0003
找到1本书：
- E0003（在线）《Machine Learning for Business》作者：Doug Hudgeon & Richard Nichol（2020）。可借副本：0/0。
请确认要借的书籍ID：E0003
你已借阅《Machine Learning for Business》作者：Doug Hudgeon & Richard Nichol（2020）。到期：22/09/2025。

有未支付罚款时，用户不能借书。

以学生Chris Manner登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：4
> borrow The Hobbit
找到1本书：
- P0008（实体）《The Hobbit》作者：J.R.R. Tolkien（1937）。可借副本：1/2。
请确认要借的书籍ID：P0008
无法借书：有未支付罚款。请查看借阅详情。

用户可以输入 return <X>，其中 <X> 是要归还的书籍ID。归还时，系统会自动将归还日期设为当天（TODAY），计算罚款并显示结果。

如果用户借了同一本书的多本副本，系统会优先归还到期日最早的副本（或借阅记录）。

以学生Chris Manner登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：4
> return P0006
已归还《Hands-On ML》作者：Aurelien Geron（2019）。逾期2天。罚款：$1.00
> return P0011
没有P0011的借阅记录。
> return E0001
已归还《Python Crash Course》作者：Eric Matthes（2015）。
> quit

用户输入可能不是正确命令（“borrow”、“return”或“quit”），此时程序应再次提示输入。

示例
示例1
欢迎来到图书馆
登录名：s31267
密码：chr1267
以学生Chris Manner登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：2
学生 Chris Manner。政策：最多10天，4本。当前借阅：2（1本实体/1本在线）。罚款：$1.00
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：3
你当前有2条借阅记录：
1. P0006《Hands-On ML》作者：Aurelien Geron（2019）。到期日：13/09/2025。
2. E0001《Python Crash Course》作者：Eric Matthes（2015）。到期日：15/09/2025。
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：4
> borrow The Hobbit
找到1本书：
- P0008（实体）《The Hobbit》作者：J.R.R. Tolkien（1937）。可借副本：1/2。
请确认要借的书籍ID：P0008
无法借书：有未支付罚款。请查看借阅详情。
> return P0006
已归还《Hands-On ML》作者：Aurelien Geron（2019）。逾期2天。罚款：$1.00
> return P0011
没有P0011的借阅记录。
> return E0001
已归还《Python Crash Course》作者：Eric Matthes（2015）。
> quit
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：3
你当前有0条借阅记录。
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：0
再见！

示例2
欢迎来到图书馆
登录名：e118102
密码：pa55word
以教职工Mary Alan登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：2
教职工 Mary Alan。政策：最多14天，6本。当前借阅：1（1本实体/0本在线）。罚款：$0.00
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：3
你当前有1条借阅记录：
1. P0004《银河系漫游指南》作者：Douglas Adams（1985）。到期日：17/09/2025。
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 图书馆报告
==================================
请输入你的选择：4
> borrow The Hobbit
找到1本书：
- P0008（实体）《The Hobbit》作者：J.R.R. Tolkien（1937）。可借副本：1/2。
请确认要借的书籍ID：P0007
请确认要借的书籍ID：P0008
你已借阅《The Hobbit》作者：J.R.R. Tolkien（1937）。到期：29/09/2025。
> quit
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：1
欢迎来到图书馆
登录名：s31245
密码：secure99
以学生Justin Bierber登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：4
> borrow The Hobbit
找到1本书：
- P0008（实体）《The Hobbit》作者：J.R.R. Tolkien（1937）。可借副本：0/2。
请确认要借的书籍ID：P0008
无可借副本。
> quit
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：0
再见！

示例3
欢迎来到图书馆
登录名：o56799
密码：noa6799
以其他用户Noah登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：4
> borrow Python Crash Course
找到2本书：
- E0001（在线）《Python Crash Course》作者：Eric Matthes（2015）。可借副本：0/0。
- P0003（实体）《Python Crash Course》作者：Eric Matthes（2023）。可借副本：2/2。
请确认要借的书籍ID：P0003
你已借阅《Python Crash Course》作者：Eric Matthes（2023）。到期：22/09/2025。
> borrow The Hitchhiker's Guide to the Galaxy
找到1本书：
- P0004（实体）《银河系漫游指南》作者：Douglas Adams（1985）。可借副本：0/1。
请确认要借的书籍ID：P0004
无可借副本。
> borrow The Hobbit
找到1本书：
- P0008（实体）《The Hobbit》作者：J.R.R. Tolkien（1937）。可借副本：1/2。
请确认要借的书籍ID：P0008
你已借阅《The Hobbit》作者：J.R.R. Tolkien（1937）。到期：22/09/2025。
> borrow The Art of Computer Programming
找到1本书：
- P0007（实体）《计算机程序设计艺术》作者：Donald Knuth（1997）。可借副本：2/2。
请确认要借的书籍ID：P0007
无法借书：额度已满。请查看借阅详情。
> quit
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
==================================
请输入你的选择：0
再见！

示例4
欢迎来到图书馆
登录名：e118102
密码：pa55word
以教职工Mary Alan登录
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 图书馆报告
==================================
请输入你的选择：5
图书馆报告
- 9名用户，包括4名学生、3名教职工和2名其他。
- 14本书，包括10本实体书（7本当前可借）和4本在线书。
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 图书馆报告
==================================
请输入你的选择：P01
请输入你的选择：5
图书馆报告
- 9名用户，包括4名学生、3名教职工和2名其他。
- 14本书，包括10本实体书（7本当前可借）和4本在线书。
==================================
我的图书馆账户
0. 退出
1. 注销
2. 查看账户政策
3. 查看我的借阅
4. 借书与还书
5. 图书馆报告
==================================
请输入你的选择：Python Crash Course
请输入你的选择：0
再见！
In task 1, your program is able to load data, display existing user's information and loan history. Now, it is time to help Librarian manage daily library system, including borrow and return books.

Task Description
Fines
If a user returns a physical book after its due date, or if the due date has already passed and the book remains unreturned (e.g., as of today, 15/09/2025), a fine will be applied. Online books are exempt from fines, as access to these resources is automatically revoked by the reading platform once the due date has passed.

Fines accrue only from the day after the due date (including any applicable grace period) and continue until the item is returned. For items that are still on loan, fines are calculated up to today’s date (15/09/2025). All fines are expected to be paid in full upon the return of the book.

In Task 2-5, we will assume that today is 15th September, 2025. A constant variable TODAY has been created in user.py for your convenience. You may modify it if necessary.

Per-day rate and grace period vary by role:

Users
Grace
 
(days)
Fine
 
/
 
day
Student
0
$0.50
Staff
2
$0.50
Other
0
$1.00
Users
Student
Staff
Other
​
  
Grace (days)
0
2
0
​
  
Fine / day
$0.50
$0.50
$1.00
​
 
​
 

Updated Main Menu 
Add fines information to View account policies, and add a Borrow & Return console.

Logged in as Chris Manner (Student)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 2
Student Chris Manner. Policies: maximum of 10 days, 4 items. Current loans: 2 (1 physical / 1 online). Fines: $ 1.00

Here is the modified Library staff's menu

Logged in as Mary Alan (Staff)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Library Report
==================================
Enter your choice:

Borrowing and Returning Books
For this and following tasks, do not create files or write into existing csv files.

When entering Book and Return console by choosing 4, the program will prompt users to enter commands in line marked with >. 

The user can input borrow <X> where <X> is either a book title or book ID. 

If multiple books share the same title, the program will display a list of all matching books along with their IDs (sorted by book IDs). You will then be asked to confirm the book by entering its ID. The book ID must be one from the displayed list. If you enter an invalid ID, the program will prompt you again until a valid ID is provided or you type quit.

A book can only be borrowed if  (see Example 3)

It exists in the library catalog.

Copies are still available. Online books are always available and not counted toward the borrowing quota.

You have not exceeded your borrowing quota.

You do not have any outstanding fines.

Borrowing validation priority

The system first checks whether the user is eligible to borrow, i.e. they still have available quota and then no outstanding fines.

It verifies that the requested book exists before checking the number of available copies.

Type quit to exit the borrow and return console and go back to main menu.

Logged in as Noah (Others)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 4
> borrow Hobbit
No books match 'Hobbit'.
> borrow Python Crash Course
Found 2 book(s).
- E0001 (online) 'Python Crash Course' by Eric Matthes (2015). Available copies: 0/0.
- P0003 (physical) 'Python Crash Course' by Eric Matthes (2023). Available copies: 2/2.
Confirm the Book ID you'd like to borrow: P0003
You have borrowed 'Python Crash Course' by Eric Matthes (2023). Due: 22/09/2025.
> quit
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice:

Users can also borrow by book ID

> borrow E0003
Found 1 book(s).
- E0003 (online) 'Machine Learning for Business' by Doug Hudgeon & Richard Nichol (2020). Available copies: 0/0.
Confirm the Book ID you'd like to borrow: E0003
You have borrowed 'Machine Learning for Business' by Doug Hudgeon & Richard Nichol (2020). Due: 22/09/2025.
Users cannot borrow books if they have any outstanding fines.

Logged in as Chris Manner (Student)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 4
> borrow The Hobbit
Found 1 book(s).
- P0008 (physical) 'The Hobbit' by J.R.R. Tolkien (1937). Available copies: 1/2.
Confirm the Book ID you'd like to borrow: P0008
Borrowing unavailable: unpaid fines. Review your loan details for more info.

The user can input return <X> where <X> is the book ID to return. When a book is returned, the system will automatically set the return date to the current day (TODAY), calculate any applicable fines, and display the result.

If the user has borrowed multiple copies of the same book, the system will return the copy (or loan) with the earliest due date first.

Logged in as Chris Manner (Student)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 4
> return P0006
Returned 'Hands-On ML' by Aurelien Geron (2019). Overdue by 2 day(s). Fine: $ 1.00
> return P0011
No loan record for P0011.
> return E0001
Returned 'Python Crash Course' by Eric Matthes (2015).
> quit

A user's input may not begin with a correct command name ("borrow", "return", or "quit"). In this case your program should prompt for input again.

Examples
Example 1
Welcome to Library
Login as: s31267
Password: chr1267
Logged in as Chris Manner (Student)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 2
Student Chris Manner. Policies: maximum of 10 days, 4 items. Current loans: 2 (1 physical / 1 online). Fines: $ 1.00
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 3
You are currently have 2 loan(s).
1. P0006 'Hands-On ML' by Aurelien Geron (2019). Due date: 13/09/2025.
2. E0001 'Python Crash Course' by Eric Matthes (2015). Due date: 15/09/2025.
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 4
> borrow The Hobbit
Found 1 book(s).
- P0008 (physical) 'The Hobbit' by J.R.R. Tolkien (1937). Available copies: 1/2.
Confirm the Book ID you'd like to borrow: P0008
Borrowing unavailable: unpaid fines. Review your loan details for more info.
> return P0006
Returned 'Hands-On ML' by Aurelien Geron (2019). Overdue by 2 day(s). Fine: $ 1.00
> return P0011
No loan record for P0011.
> return E0001
Returned 'Python Crash Course' by Eric Matthes (2015).
> quit
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 3
You are currently have 0 loan(s).
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 0
Goodbye!

Example 2
Welcome to Library
Login as: e118102
Password: pa55word
Logged in as Mary Alan (Staff)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 2
Staff Mary Alan. Policies: maximum of 14 days, 6 items. Current loans: 1 (1 physical / 0 online). Fines: $ 0.00
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 3
You are currently have 1 loan(s).
1. P0004 'The Hitchhiker's Guide to the Galaxy' by Douglas Adams (1985). Due date: 17/09/2025.
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 4
> borrow The Hobbit
Found 1 book(s).
- P0008 (physical) 'The Hobbit' by J.R.R. Tolkien (1937). Available copies: 1/2.
Confirm the Book ID you'd like to borrow: P0007
Confirm the Book ID you'd like to borrow: P0008
You have borrowed 'The Hobbit' by J.R.R. Tolkien (1937). Due: 29/09/2025.
> quit
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 1
Welcome to Library
Login as: s31245
Password: secure99
Logged in as Justin Bierber (Student)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 4
> borrow The Hobbit
Found 1 book(s).
- P0008 (physical) 'The Hobbit' by J.R.R. Tolkien (1937). Available copies: 0/2.
Confirm the Book ID you'd like to borrow: P0008
No copies available.
> quit
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 0
Goodbye!

Example 3
Welcome to Library
Login as: o56799
Password: noa6799
Logged in as Noah (Others)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 4
> borrow Python Crash Course
Found 2 book(s).
- E0001 (online) 'Python Crash Course' by Eric Matthes (2015). Available copies: 0/0.
- P0003 (physical) 'Python Crash Course' by Eric Matthes (2023). Available copies: 2/2.
Confirm the Book ID you'd like to borrow: P0003
You have borrowed 'Python Crash Course' by Eric Matthes (2023). Due: 22/09/2025.
> borrow The Hitchhiker's Guide to the Galaxy
Found 1 book(s).
- P0004 (physical) 'The Hitchhiker's Guide to the Galaxy' by Douglas Adams (1985). Available copies: 0/1.
Confirm the Book ID you'd like to borrow: P0004
No copies available.
> borrow The Hobbit
Found 1 book(s).
- P0008 (physical) 'The Hobbit' by J.R.R. Tolkien (1937). Available copies: 1/2.
Confirm the Book ID you'd like to borrow: P0008
You have borrowed 'The Hobbit' by J.R.R. Tolkien (1937). Due: 22/09/2025.
> borrow The Art of Computer Programming
Found 1 book(s).
- P0007 (physical) 'The Art of Computer Programming' by Donald Knuth (1997). Available copies: 2/2.
Confirm the Book ID you'd like to borrow: P0007
Borrowing unavailable: quota reached. Review your loan details for more info.
> quit
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
==================================
Enter your choice: 0
Goodbye!

Example 4
Welcome to Library
Login as: e118102
Password: pa55word
Logged in as Mary Alan (Staff)
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Library Report
==================================
Enter your choice: 5
Library report
- 9 users, including 4 student(s), 3 staff, and 2 others.
- 14 books, including 10 physical book(s) (7 currently available) and 4 online book(s).
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Library Report
==================================
Enter your choice: P01
Enter your choice: 5
Library report
- 9 users, including 4 student(s), 3 staff, and 2 others.
- 14 books, including 10 physical book(s) (7 currently available) and 4 online book(s).
==================================
My Library Account
0. Quit
1. Log out
2. View account policies
3. View my loans
4. Borrow and Return
5. Library Report
==================================
Enter your choice: Python Crash Course
Enter your choice: 0
Goodbye!