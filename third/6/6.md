Task 6 - Navigating a Multi-Level Library [12 marks]
Backgrounds
Universities often operate multiple library branches to serve different faculties and disciplines (e.g., IT, Pharmacy, Arts). While this improves accessibility, it also creates challenges such as duplicated books across branches, managing cross-branch requests, and ensuring consistent search results. To address these issues, libraries use integrated management systems with unified catalogues and discovery layers.

In this assignment, the book collection is provided in the data folder, organised in a hierarchical structure. Each top-level folder corresponds to a library branch. Within each branch, books are further grouped by subjects and categories. At the lowest level, each category is represented as a CSV file (e.g., machinelearning.csv) containing book records with attributes such as book_id, title, author, year, and keywords .

For example, let's take a look at the Pharmacy Library in data/PharmacyLibrary. The library can have the following structure:

PharmacyLibrary
--Biology
----bioinformatics
------machinelearning.csv
------mathematics.csv
--education.csv
Your Tasks
You may define a recursive helper function inside your solution. The provided function itself does not need to be recursive, as long as recursion is used somewhere in your implementation.

In Task 6, you can assume all CSV files contain valid data.

Part 1
Using recursive approach, implement a function read_book_collection(data_path: str) -> dict: to read the library book collection at data_path and returns a nested dictionary structure representing a hierarchical structure of books at different library branches, where library branches, faculties, and departments are represented as dictionaries, and categories are listed as keys. The hierarchy should mirror the folder structure and each book record must include attributes such as book_id, type, copies, title, author, year, and keywords.

A book may have multiple authors, separated by &.

Keywords are separated by : (as in previous tasks).

Example - a result hierarchical structure of book distributions in Pharmacy Library (PharmacyLibrary)

>>> books_dict = read_book_collection('data/PharmacyLibrary')
>>> books_dict
{'biology': 
   {'bioinformatics': 
       {'machinelearning': [
           {'book_id': 'P0003', 'type': 'physical', 'copies': 1, 'title': 'Python Crash Course', 'author': ['Eric Matthes'], 'year': 2023, 'keywords': ['python', 'programming']}, 
           {'book_id': 'P0001', 'type': 'physical', 'copies': 1, 'title': 'Introduction to Python Programming', 'author': ['S Gowrishankar'], 'year': 2019, 'keywords': ['python', 'programming']}
         ], 
        'mathematics': [
           {'book_id': 'P0025', 'type': 'physical', 'copies': 3, 'title': 'Introduction to mathematical statistics', 'author': ["Hogg Robert V", "Craig Allen T"], 'year': 2013, 'keywords': ['statistics', 'mathematical statistics']}
         ]
        }
    },
   'education': [
       {'book_id': 'P0020', 'type': 'physical', 'copies': 1, 'title': 'Research methods', 'author': ['McBurney Donald'], 'year': 2010, 'keywords': ['Research', 'Research methods']},
       {'book_id': 'P0009', 'type': 'physical', 'copies': 1, 'title': 'Bad Science: A hilarious and informative Sunday Times bestseller on bad science in healthcare', 'author': ['Ben Goldacre'], 'year': 2008, 'keywords': ['science', 'statistics', 'healthcare']}
    ]
}

Part 2
The librarian wants to generate statistics on the number of books available in each category across the library system.

Your task is to use a recursive approach to implement function  count_books_by_category(data: dict, book_cat: str) -> int 

Input:

data: the hierarchical dictionary of book collections (as constructed in Part 1).

book_cat: the name of a category (e.g., "machinelearning", "deeplearning", "social_science").

Output

Returns the total number of books that belong to the specified category, regardless of which branch or department they are located in.

Examples

>>>count_books_by_categories(data,'machinelearning')
4
>>>count_books_by_categories(data,'deeplearning')
3
>>>count_books_by_categories(data,'social_science')
4 
>>>count_books_by_categories(data,'education')
6

Part 3
The librarian would like to retrieve all books written by a specific author.

Your task is to use a recursive approach to implement the function find_books_by_author(data: dict, author: str) -> list

Input:

data:  the hierarchical dictionary of book collections (as constructed in Part 1).

author: the name of the author to search for.

Output:

A list of book dictionaries, where each dictionary represents a book written by the given author.

Each returned book dictionary must also include an additional field, category, which records the full path of the category in which the book is located. task6 要求



print(find_books_by_author(data, 'Eric Matthes'))
[{'book_id': 'P0003', 'type': 'physical', 'copies': 2, 'title': 'Python Crash Course', 'author': ['Eric Matthes'], 'year': 2023, 'keywords': ['python', 'programming'], 'category': '/LawLibrary/computerscience'}, 
{'book_id': 'E0001', 'type': 'online', 'copies': 0, 'title': 'Python Crash Course', 'author': ['Eric Matthes'], 'year': 2015, 'keywords': ['python', 'programming'], 'category': '/LawLibrary/economics/economics'}, 
{'book_id': 'E0001', 'type': 'online', 'copies': 0, 'title': 'Python Crash Course', 'author': ['Eric Matthes'], 'year': 2015, 'keywords': ['python', 'programming'], 'category': '/MathesonLibrary/education'}, 
{'book_id': 'P0003', 'type': 'physical', 'copies': 1, 'title': 'Python Crash Course', 'author': ['Eric Matthes'], 'year': 2023, 'keywords': ['python', 'programming'], 'category': '/PharmacyLibrary/biology/bioinformatics/machinelearning'}] task6 例子1




Part 4
The librarian would like to enhance the search system so that users can find books not only by exact keyword matches but also by similarity of keywords (case insensitive). To achieve this, we will use the Jaccard similarity to measure the overlap between words in two texts. 

Jaccard similarity score is calculated by dividing the number of shared elements (intersection) by the total number of unique elements in both sets (union). 

Let's say a user searches for books related to python programming, and we have a book titled Introduction to Python Programming. We want to measure how similar the search query is to the book's title using the Jaccard similarity score.

The keyword list is ["python", "programming"]

The unique words in the book title are ["introduction", "to", "python", "programming"]

The intersection between keywords and the book title is ["python", "programming"] (length of 2)

The union is ["introduction", "to", "python", "programming"] (length of 4)

Hence, the Jaccard similarity score is 2 / 4 = 0.5


Expand
 Jaccard  index  (for your interest, please refer to this link) measures similarity between finite non-empty sample sets and is defined as the size of the intersection divided by the size of the union of the sample sets.  Suppose we have non-empty A and B sets, jaccard index is calculated using the formula:

J
(
A
,
B
)
 
=
 
∣
A
∩
B
∣
∣
A
∪
B
=
∣
A
∩
B
∣
∣
A
∣
+
∣
B
∣
−
∣
A
∩
B
∣
J(A,B) =  
∣A∪B
∣A∩B∣
​
 = 
∣A∣+∣B∣−∣A∩B∣
∣A∩B∣
​
 

where, 

0
≤
J
(
A
,
B
)
≤
1
0≤J(A,B)≤1

 J(A,B) = 0  means there is no similarity between A and B.

J(A,B) = 1 means A is identical to B. 

Your task is use a recursive approach to implement a function search_by_keywords(data: dict, keywords: list, similarity_threshold: float) -> list

Input:

data:  the hierarchical dictionary of book collections (as constructed in Part 1).

keywords: a list of search keywords.

similarity_threshold: the minimum similarity score a book must have to be considered relevant.

Output:

A list of the most relevant books, each represented as a dictionary. Each returned book dictionary must also include additional fields, category, which records the full path of the category in which the book is located, and the similarity score .

The results should be sorted first by similarity score (descending) and then by year (descending). task 6 接下来




Example 1:

>>>search_by_keywords(books_dict,['python', 'programming'], 0.25))
[{'book_id': 'P0001', 'type': 'physical', 'copies': 1, 'title': 'Introduction to Python Programming', 'author': ['S Gowrishankar'], 'year': 2019, 'keywords': ['python', 'programming'], 'category': '/PharmacyLibrary/biology/bioinformatics/machinelearning', 'score': 0.5}, 
{'book_id': 'P0003', 'type': 'physical', 'copies': 2, 'title': 'Python Crash Course', 'author': ['Eric Matthes'], 'year': 2023, 'keywords': ['python', 'programming'], 'category': '/LawLibrary/computerscience', 'score': 0.25},
{'book_id': 'P0003', 'type': 'physical', 'copies': 1, 'title': 'Python Crash Course', 'author': ['Eric Matthes'], 'year': 2023, 'keywords': ['python', 'programming'], 'category': '/PharmacyLibrary/biology/bioinformatics/machinelearning', 'score': 0.25},
{'book_id': 'E0001', 'type': 'online', 'copies': 0, 'title': 'Python Crash Course', 'author': ['Eric Matthes'], 'year': 2015, 'keywords': ['python', 'programming'], 'category': '/LawLibrary/economics/economics', 'score': 0.25},
{'book_id': 'E0001', 'type': 'online', 'copies': 0, 'title': 'Python Crash Course', 'author': ['Eric Matthes'], 'year': 2015, 'keywords': ['python', 'programming'], 'category': '/MathesonLibrary/education', 'score': 0.25}] 这个是task6最后一个part的例子